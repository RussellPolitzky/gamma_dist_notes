---
title: "Deep Seek Prover 2: Detailed Derivation of BCL as Gamma GLM"
author: "DeepSeek Prover"
format:
  html:
    toc: true
    code-fold: true
    code-tools: true
---

## üìê Detailed Derivation of the Score Equation in the GLM Framework for Chain Ladder

This section rigorously derives the maximum likelihood estimate ($\hat{\beta}_j$) for the Generalized Linear Model (GLM) formulation that is equivalent to the **Volume-Weighted Basic Chain Ladder (BCL)** method.

---

### 1. GLM Components Specification

The GLM is precisely defined to match the underlying calculation of the BCL development factors:

* **Response variable ($Y_{i,j}$)**: The **ratio of cumulative claims** for accident year $i$ from development period $j-1$ to $j$.
    $$
    Y_{i,j} = \frac{C_{i,j}}{C_{i,j-1}}
    $$
* **Weights ($w_{i,j}$)**: The **cumulative claims at the start** of the development period.
    $$
    w_{i,j} = C_{i,j-1}
    $$
* **Linear Predictor ($\eta_{i,j}$)**: A constant for each development period $j$.
    $$
    \eta_{i,j} = \beta_j
    $$
* **Link Function**: **Inverse link**, which connects the expected response $\mu_{i,j}$ to the linear predictor $\eta_{i,j}$:
    $$
    \eta_{i,j} = \frac{1}{\mu_{i,j}}, \quad \text{where } \mu_{i,j} = E[Y_{i,j}]
    $$
* **Distribution**: **Gamma Distribution**, often used for positive, non-negative, and right-skewed data like claim ratios, with $\text{Var}(Y) = \phi \mu^2$.

---

### 2. Gamma Distribution Log-Likelihood

The probability density function (PDF) for a Gamma-distributed variable $Y$ with mean $\mu$ and shape parameter $\alpha$ (where $\alpha = 1/\phi$) contains terms that are simplified for the log-likelihood:

$$
f(y; \mu, \alpha) = \frac{1}{\Gamma(\alpha)} \left( \frac{\alpha y}{\mu} \right)^\alpha e^{-\alpha y / \mu} \frac{1}{y}
$$

The log-likelihood for a single observation $\ell$ (ignoring terms that do not involve $\mu$) is:

$$
\ell \propto - \alpha \log \mu_{i,j} - \frac{\alpha Y_{i,j}}{\mu_{i,j}}
$$

For **weighted observations**, the total log-likelihood $\mathcal{L}$ sums across all data points $(i, j)$:

$$
\mathcal{L} = \sum_{i,j} w_{i,j} \left( - \alpha \log \mu_{i,j} - \frac{\alpha Y_{i,j}}{\mu_{i,j}} \right) + \text{const.}
$$

Substituting the inverse link, $\mu_{i,j} = 1/\beta_j$:

$$
\mathcal{L} = \sum_{i,j} w_{i,j} \left( - \alpha \log \left( \frac{1}{\beta_j} \right) - \frac{\alpha Y_{i,j}}{1/\beta_j} \right) + \text{const.}
$$

Since $\log(1/\beta_j) = -\log(\beta_j)$:

$$
\mathcal{L} = \sum_{i,j} w_{i,j} \left( \alpha \log \beta_j - \alpha Y_{i,j} \beta_j \right) + \text{const.}
$$

---

### 3. Score Equation for $\beta_j$

The **score equation** is found by taking the derivative of the log-likelihood with respect to the parameter $\beta_j$ (only summing over accident years $i$ for a fixed development period $j$) and setting it to zero to find the maximum likelihood estimate:

$$
\frac{\partial \mathcal{L}}{\partial \beta_j} = \sum_i w_{i,j} \left( \frac{\partial}{\partial \beta_j} \left[ \alpha \log \beta_j \right] - \frac{\partial}{\partial \beta_j} \left[ \alpha Y_{i,j} \beta_j \right] \right) = 0
$$

**Compute the derivatives:**

1.  $\frac{\partial}{\partial \beta_j} \left[ \alpha \log \beta_j \right] = \alpha \frac{1}{\beta_j}$
2.  $\frac{\partial}{\partial \beta_j} \left[ \alpha Y_{i,j} \beta_j \right] = \alpha Y_{i,j}$

**Substitute back:**

$$
\sum_i w_{i,j} \left( \alpha \frac{1}{\beta_j} - \alpha Y_{i,j} \right) = 0
$$

Since the dispersion parameter $\alpha$ is a positive constant, we can factor it out and cancel it:

$$
\sum_i w_{i,j} \left( \frac{1}{\beta_j} - Y_{i,j} \right) = 0
$$

---

### 4. Solving for $\beta_j$

Rearrange the simplified score equation:

$$
\sum_i w_{i,j} \frac{1}{\beta_j} = \sum_i w_{i,j} Y_{i,j}
$$

Substitute the definitions for the **weights** $w_{i,j} = C_{i,j-1}$ and the **response** $Y_{i,j} = \frac{C_{i,j}}{C_{i,j-1}}$:

$$
\sum_i C_{i,j-1} \frac{1}{\beta_j} = \sum_i C_{i,j-1} \frac{C_{i,j}}{C_{i,j-1}}
$$

Simplify the right-hand side, where the terms $C_{i,j-1}$ cancel:

$$
\frac{1}{\beta_j} \sum_i C_{i,j-1} = \sum_i C_{i,j}
$$

Finally, solve for $\beta_j$:

$$
\beta_j = \frac{\sum_i C_{i,j-1}}{\sum_i C_{i,j}}
$$

### 5. Final Equivalence

This estimated coefficient $\hat{\beta}_j$ is exactly the **reciprocal** of the volume-weighted Chain Ladder Development Factor ($F_j$):

$$
F_j = \frac{\sum_{i} C_{i,j}}{\sum_{i} C_{i,j-1}} \quad \implies \quad \hat{\beta}_j = \frac{1}{F_j}
$$

The GLM's projected mean $\hat{Y}_{i,j} = 1/\hat{\beta}_j = F_j$, leading to the Chain Ladder projection:
$$
\hat{C}_{i,j} = C_{i,j-1} \cdot \hat{Y}_{i,j} = C_{i,j-1} \cdot F_j
$$

This completes the rigorous proof of the exact correspondence.

Would you like to see how a more complex GLM, perhaps incorporating **accident year factors**, is structured for actuarial reserving?